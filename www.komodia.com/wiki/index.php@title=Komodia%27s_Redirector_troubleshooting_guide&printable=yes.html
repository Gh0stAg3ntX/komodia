<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>Komodia's Redirector troubleshooting guide - Komodia</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.20.4" />
<meta name="robots" content="noindex,follow" />
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Komodia (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api.php@action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Komodia Atom feed" href="index.php@title=Special%253ARecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php@debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.monobook&amp;only=styles&amp;printable=1&amp;skin=monobook&amp;%252A.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: komod_wikidb:resourceloader:filter:minify-css:7:dffa96a73b1be9b0dae7e17005fcc939 */</style>

<script src="load.php@debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;skin=monobook&amp;%252A"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Komodia\'s_Redirector_troubleshooting_guide","wgTitle":"Komodia\'s Redirector troubleshooting guide","wgCurRevisionId":1418,"wgArticleId":36,"wgIsArticle":true,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Komodia\'s_Redirector_troubleshooting_guide","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,
"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});
/* cache key: komod_wikidb:resourceloader:filter:minify-js:7:c89fc005766e312c555f83b307d08d63 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Komodia_s_Redirector_troubleshooting_guide skin-monobook action-view">
<div id="globalWrapper">
<div id="column-content"><div id="content" class="mw-body-primary">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading"><span dir="auto">Komodia's Redirector troubleshooting guide</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From Komodia</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav" class="mw-jump">Jump to: <a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#column-one">navigation</a>, <a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#searchInput">search</a></div>
		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>When deploying a product for end user there are many variance such as pre-existing LSPs, trying to install from non-admin user, security products, system corruption and more, this guide will go over which logs the Redirector creates, their location and why they are needed.
</p><p>These logs should not be confused with the "sniffing" log: <a href="index.php/Komodia's_Redirector_installation_guide.html#Log_control" title="Komodia's Redirector installation guide">Komodia's Redirector installation guide#Log_control</a>.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Common_problems"><span class="tocnumber">1</span> <span class="toctext">Common problems</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Installation"><span class="tocnumber">1.1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Browsers_not_intercepted"><span class="tocnumber">1.2</span> <span class="toctext">Browsers not intercepted</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#SSL_Error_dialog"><span class="tocnumber">1.3</span> <span class="toctext">SSL Error dialog</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Not_intercepting_localhost"><span class="tocnumber">1.4</span> <span class="toctext">Not intercepting localhost</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Not_intercepting_services"><span class="tocnumber">1.5</span> <span class="toctext">Not intercepting services</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#No_traffic_is_intercepted_at_all"><span class="tocnumber">1.6</span> <span class="toctext">No traffic is intercepted at all</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#DLL_framework_is_not_working"><span class="tocnumber">1.7</span> <span class="toctext">DLL framework is not working</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Can.27t_break_point_into_the_DLL_with_a_debugger"><span class="tocnumber">1.8</span> <span class="toctext">Can't break point into the DLL with a debugger</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Internet_breaks_instantly_or_after_a_period_of_time"><span class="tocnumber">1.9</span> <span class="toctext">Internet breaks instantly or after a period of time</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Logs"><span class="tocnumber">2</span> <span class="toctext">Logs</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Uploading_logs_to_server"><span class="tocnumber">2.1</span> <span class="toctext">Uploading logs to server</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Which_logs_are_always_present_and_which_should_be_enabled"><span class="tocnumber">2.2</span> <span class="toctext">Which logs are always present and which should be enabled</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Logs_location_summary"><span class="tocnumber">2.3</span> <span class="toctext">Logs location summary</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Enabling_LSP_log"><span class="tocnumber">2.3.1</span> <span class="toctext">Enabling LSP log</span></a>
<ul>
<li class="toclevel-4 tocsection-16"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#32bit_OS"><span class="tocnumber">2.3.1.1</span> <span class="toctext">32bit OS</span></a>
<ul>
<li class="toclevel-5 tocsection-17"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Normal_log"><span class="tocnumber">2.3.1.1.1</span> <span class="toctext">Normal log</span></a></li>
<li class="toclevel-5 tocsection-18"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Verbose_log"><span class="tocnumber">2.3.1.1.2</span> <span class="toctext">Verbose log</span></a></li>
</ul>
</li>
<li class="toclevel-4 tocsection-19"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#64bit_OS"><span class="tocnumber">2.3.1.2</span> <span class="toctext">64bit OS</span></a>
<ul>
<li class="toclevel-5 tocsection-20"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Normal_log_2"><span class="tocnumber">2.3.1.2.1</span> <span class="toctext">Normal log</span></a></li>
<li class="toclevel-5 tocsection-21"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Verbose_log_2"><span class="tocnumber">2.3.1.2.2</span> <span class="toctext">Verbose log</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-3 tocsection-22"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Enabling_full_service_log"><span class="tocnumber">2.3.2</span> <span class="toctext">Enabling full service log</span></a>
<ul>
<li class="toclevel-4 tocsection-23"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#32bit_OS_2"><span class="tocnumber">2.3.2.1</span> <span class="toctext">32bit OS</span></a></li>
<li class="toclevel-4 tocsection-24"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#64bit_OS_2"><span class="tocnumber">2.3.2.2</span> <span class="toctext">64bit OS</span></a>
<ul>
<li class="toclevel-5 tocsection-25"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#32bit_PCProxy"><span class="tocnumber">2.3.2.2.1</span> <span class="toctext">32bit PCProxy</span></a></li>
<li class="toclevel-5 tocsection-26"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#64bit_PCProxy"><span class="tocnumber">2.3.2.2.2</span> <span class="toctext">64bit PCProxy</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#LSP_installation"><span class="tocnumber">2.4</span> <span class="toctext">LSP installation</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Service_installation"><span class="tocnumber">2.5</span> <span class="toctext">Service installation</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Service_run_log"><span class="tocnumber">2.6</span> <span class="toctext">Service run log</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#What_to_do_with_the_logs"><span class="tocnumber">2.7</span> <span class="toctext">What to do with the logs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-31"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Other_topics"><span class="tocnumber">3</span> <span class="toctext">Other topics</span></a>
<ul>
<li class="toclevel-2 tocsection-32"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#DCOM_event_message"><span class="tocnumber">3.1</span> <span class="toctext">DCOM event message</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-33"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Suggestion_for_a_loopback_test"><span class="tocnumber">4</span> <span class="toctext">Suggestion for a loopback test</span></a></li>
<li class="toclevel-1 tocsection-34"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#32bit_and_64bit"><span class="tocnumber">5</span> <span class="toctext">32bit and 64bit</span></a></li>
<li class="toclevel-1 tocsection-35"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#Watchdog"><span class="tocnumber">6</span> <span class="toctext">Watchdog</span></a>
<ul>
<li class="toclevel-2 tocsection-36"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#SDK_is_not_protected"><span class="tocnumber">6.1</span> <span class="toctext">SDK is not protected</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#I_added_registry_rules_but_they_aren.27t_protected"><span class="tocnumber">6.2</span> <span class="toctext">I added registry rules but they aren't protected</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#I_tried_to_protect_a_directory.2C_but_it_isn.27t_protected"><span class="tocnumber">6.3</span> <span class="toctext">I tried to protect a directory, but it isn't protected</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#I_tried_using_the_64bit_WD_but_I.27m_getting_errors"><span class="tocnumber">6.4</span> <span class="toctext">I tried using the 64bit WD but I'm getting errors</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#I_signed_my_64bit_WD_but_it.27s_not_protecting_or_I.27m_still_getting_errors"><span class="tocnumber">6.5</span> <span class="toctext">I signed my 64bit WD but it's not protecting or I'm still getting errors</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;printable=yes.html#My_32bit_WD_works_perfectly_on_XP.2FVista_but_some_registry_keys_are_not_protected_on_Win7"><span class="tocnumber">6.6</span> <span class="toctext">My 32bit WD works perfectly on XP/Vista but some registry keys are not protected on Win7</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Common_problems"> Common problems </span></h1>
<h2> <span class="mw-headline" id="Installation"> Installation </span></h2>
<p>The most common "problem" we see in failed installation is because of executing the install/uninstall process without giving UAC privileges. The confusion is because admin user is not UAC enabled by default. The UAC dialog is the one asking for more privileges before installing a software. <a class="external text" href="http://en.wikipedia.org/wiki/User_Account_Control">More on UAC</a>
</p>
<h2> <span class="mw-headline" id="Browsers_not_intercepted"> Browsers not intercepted </span></h2>
<p>Any process that is open during the LSP install will not be intercepted, make sure to close any running network process.
</p>
<h2> <span class="mw-headline" id="SSL_Error_dialog"> SSL Error dialog </span></h2>
<p>SSL Certificate error during browsing means the root CA wasn't installed correctly, the SDK installs the certificate on startup, but it will not do so for Firefox and Opera if they are running during the startup process, also IE and Chrome may not use the new root CA if they were open as well, the solution is to close all browsers on first install.
</p>
<h2> <span class="mw-headline" id="Not_intercepting_localhost"> Not intercepting localhost </span></h2>
<p>The SDK only intercepts localhost when it's enabled to do so, it's enabled in the code only.
</p>
<h2> <span class="mw-headline" id="Not_intercepting_services"> Not intercepting services </span></h2>
<p>The SDK is configured to either intercept or not intercept services, this can be changed, also you can use the custom flag intservices and set it to 1, this will inverse the SDK default behavior.
</p>
<h2> <span class="mw-headline" id="No_traffic_is_intercepted_at_all"> No traffic is intercepted at all </span></h2>
<p>First you need to make sure that you receive traffic:
</p>
<ul><li> Enable traffic logging, see if you get the data: <a href="index.php/Komodia's_Redirector_installation_guide.html#Log_control" title="Komodia's Redirector installation guide">Komodia's Redirector installation guide#Log_control</a>.
</li><li> If your version have the HTTP Parser then you can use the "Online traffic button" in PCController.
</li></ul>
<p>If you don't get traffic then check the following items:
</p>
<ul><li> If using LSPs, that they are registered by running the register LSP app from the command prompt: 
<ul><li> Using: "registerlsp -p"
</li><li> On 64bit machines also check 64 bit LSP: "registerlsp64 -p"
</li></ul>
</li><li> If using WFP, you can check if it's installed and running from the WFP button on PCController.
</li><li> If using WFP, make sure you clicked on save after setting the interception rules.
</li><li> Redirector is not in disable mode, press on the "Toggle disable mode" on PCController to see if it's bypassed or not.
</li><li> Check Redirection rules, that they are matching the traffic you planned to intercept.
</li><li> Check that the browsers have no proxy configured, and if they do, check if the proxy port is inside your redirection rules or not.
<ul><li> If the 3rd party proxy is on the local machine, make sure you're not intercepting it as well, causing an infinite loop.
</li></ul>
</li><li> Run "netstat -ao" from command prompt and see which ports the app you're trying to intercept is using, see that they match the interception rules.
<ul><li> Also see which other application is generating traffic, see if the traffic was intercepted by a 3rd party and is sent to the Internet via a transparent proxy.
</li></ul>
</li></ul>
<h2> <span class="mw-headline" id="DLL_framework_is_not_working"> DLL framework is not working </span></h2>
<p>Check the following items:
</p>
<ul><li> After you set the DLL you pressed save and restarted the service.
</li><li> Check in the logs under c:\windows\temp\pcproxy.log that the DLL was loaded correctly, sometimes DLL are compiled in a way that they have dependencies issues.
</li><li> Check that the SDK receives traffic at all, if not troubleshoot with the above methods.
</li></ul>
<h2> <span class="mw-headline" id="Can.27t_break_point_into_the_DLL_with_a_debugger"> Can't break point into the DLL with a debugger </span></h2>
<p>Check the following items:
</p>
<ul><li> That you receive traffic.
</li><li> That the DLL is loaded correctly.
</li><li> That you break pointed into pcproxy.exe
</li></ul>
<h2> <span class="mw-headline" id="Internet_breaks_instantly_or_after_a_period_of_time"> Internet breaks instantly or after a period of time </span></h2>
<p>Usually the case is that the client's logic (DLL or COM framework) fails in a way, for example, NewConnection function returning false or crashes.
</p><p>To verify, install the SDK but don't deploy the software or DLL, and see of traffic is intercepted.
</p>
<h1> <span class="mw-headline" id="Logs"> Logs </span></h1>
<h2> <span class="mw-headline" id="Uploading_logs_to_server"> Uploading logs to server </span></h2>
<p>The logs can be uploaded to Komodia's server using the syntax:
</p>
<pre>
PCProxy /UploadLogs
</pre>
<p>The server is not monitored, so you will need to contract us to look at the logs.
</p>
<h2> <span class="mw-headline" id="Which_logs_are_always_present_and_which_should_be_enabled"> Which logs are always present and which should be enabled </span></h2>
<ul><li> LSP Installer log - Always enabled.
</li><li> LSP log - Disabled.
</li><li> Service install log - Enabled.
</li><li> Service running log - Partially enabled.
</li></ul>
<h2> <span class="mw-headline" id="Logs_location_summary"> Logs location summary </span></h2>
<p>Under the installing user&#160;%temp% directory you have:
</p>
<ul><li> RegisterLSP.log
</li><li> PCProxy.log
</li><li> PCProxyr.log
</li></ul>
<p>(PCProxy would be replaced with the binary name you are using)
</p><p>Under windows temp directory, which is usually: c:\windows\temp you have:
</p>
<ul><li> PCProxy.log
</li><li> PCProxyr.log
</li></ul>
<h3> <span class="mw-headline" id="Enabling_LSP_log"> Enabling LSP log </span></h3>
<h4> <span class="mw-headline" id="32bit_OS"> 32bit OS </span></h4>
<h5> <span class="mw-headline" id="Normal_log"> Normal log </span></h5>
<p>To enable the log add the value (DWORD): lsplog to the key: HKEY_LOCAL_MACHINE\Software\Komodia
</p>
<h5> <span class="mw-headline" id="Verbose_log"> Verbose log </span></h5>
<p>To enable the verbose log (usualy based on request from Komodia's personal) add the value (DWORD): lspverbose to the key: HKEY_LOCAL_MACHINE\Software\Komodia
</p>
<h4> <span class="mw-headline" id="64bit_OS"> 64bit OS </span></h4>
<h5> <span class="mw-headline" id="Normal_log_2"> Normal log </span></h5>
<p>To enable the log add the value (DWORD): lsplog to the key: HKEY_LOCAL_MACHINE\Software\WOW6432Node\Komodia
</p>
<h5> <span class="mw-headline" id="Verbose_log_2"> Verbose log </span></h5>
<p>To enable the verbose log (usualy based on request from Komodia's personal) add the value (DWORD): lspverbose to the key: HKEY_LOCAL_MACHINE\WOW6432Node\Software\Komodia
</p>
<h3> <span class="mw-headline" id="Enabling_full_service_log"> Enabling full service log </span></h3>
<h4> <span class="mw-headline" id="32bit_OS_2"> 32bit OS </span></h4>
<p>The full service log includes details about the interception rules, to enable it add the value (DWORD): pcproxy to the key: HKEY_LOCAL_MACHINE\Software\Komodia
</p>
<h4> <span class="mw-headline" id="64bit_OS_2"> 64bit OS </span></h4>
<h5> <span class="mw-headline" id="32bit_PCProxy"> 32bit PCProxy </span></h5>
<p>The full service log includes details about the interception rules, to enable it add the value (DWORD): pcproxy to the key: HKEY_LOCAL_MACHINE\Software\WOW6432Node\Komodia
</p>
<h5> <span class="mw-headline" id="64bit_PCProxy"> 64bit PCProxy </span></h5>
<p>The full service log includes details about the interception rules, to enable it add the value (DWORD): pcproxy to the key: HKEY_LOCAL_MACHINE\Software\Komodia
</p>
<h2> <span class="mw-headline" id="LSP_installation"> LSP installation </span></h2>
<p>RegisterLSP.EXE or it's DLL or COM equivilence creates a log called "RegisterLSP.log" under the&#160;%temp% directory of the installing user, this log has the following information inside:
</p>
<ul><li> OS (and 32/64 bit)
</li><li> Was it UAC provided (on Vista and above OS)
</li><li> RegisterLSP location
</li><li> Working directory
</li><li> Existing security products (that the RegisterLSP is aware of)
</li><li> Install outcome
</li></ul>
<p>LSP installation problems are seen right away in the install log.
</p>
<h2> <span class="mw-headline" id="Service_installation"> Service installation </span></h2>
<p>The service creates an install log under the&#160;%temp% directory of the installing the user, the log name is usualy the process name with the letter 'r', for example the default log name for: "PCProxy.exe" is "PCProxyr.log", this name can be changed for clients with the source code.
</p><p>This log has the following information inside:
</p>
<ul><li> OS (and 32/64 bit)
</li><li> Was it UAC provided (on Vista and above OS)
</li><li> Redirector location
</li><li> Working directory
</li><li> Install outcome
</li></ul>
<h2> <span class="mw-headline" id="Service_run_log"> Service run log </span></h2>
<p>The service creates a run log under the&#160;%temp% of the running user, because the Redirector is a service under the Local System account this temp directory is c:\windows\temp
</p><p>The log contains the steps taken to run the process.
</p>
<h2> <span class="mw-headline" id="What_to_do_with_the_logs"> What to do with the logs </span></h2>
<p>In case of a problem, make sure to collect these three logs and you can always forward them to Komodia's support personal for further assistance.
</p>
<h1> <span class="mw-headline" id="Other_topics"> Other topics </span></h1>
<h2> <span class="mw-headline" id="DCOM_event_message"> DCOM event message </span></h2>
<p>On some computers DCOM error events may appear in event log, to resolve this:
</p>
<ol><li> Go to Administrative tools, select component services, in component services directory select computers, then My Computer, now select DCOM Config.
</li><li> In DCOM Config, highlight PCProxy, right click and select properties and then the security tab.
</li><li> In the Launch and Activation Permissions select edit 
</li><li> Add the Group named&#160;?Service? and select all four permissions for the service (local launch, remote launch, local activation, remote activation).
</li><li> Reboot and problem should now disappear.
</li></ol>
<h1> <span class="mw-headline" id="Suggestion_for_a_loopback_test"> Suggestion for a loopback test </span></h1>
<p>Some users may want to implement a method to check they still have network after the LSP is installed in case there is some sort of conflict, this method is not 100%, but there are some issues that have to be addressed to make the loopback test more reliable, these are the steps to take:
</p>
<ol><li> Before installing the LSP save name and addresses of all interfaces (can be done with IP Helper API)
</li><li> Contact your web server, send some data, and see that you get an expected result back.
</li><li> Install the LSP.
</li><li> If you are in the same app that made the test, make sure to unload Winsock and then reload it, so the new LSP will be loaded as well.
</li><li> Verify that the network didn't change, if it did, you may not have Internet and the test will fail regardless of the LSP state.
</li><li> Do the web server test again, if there was no reply it may be that there's no Internet connection or there was a LSP conflict.
</li></ol>
<h1> <span class="mw-headline" id="32bit_and_64bit"> 32bit and 64bit </span></h1>
<p>If you changed processes from 32bit to 64bit or vice versa on the same machine, make sure you uninstalled the process of the original version.
</p>
<h1> <span class="mw-headline" id="Watchdog"> Watchdog </span></h1>
<p>Here is a list of some common problems when using the <a href="index.php/Komodia's_Watchdog.html" title="Komodia's Watchdog">Komodia's Watchdog</a> and how to resolve them.
</p>
<h2> <span class="mw-headline" id="SDK_is_not_protected"> SDK is not protected </span></h2>
<p>You can delete registry keys belonging to the SDK, delete the service or the LSP with netsh. You need to check that:
</p>
<ol><li> You installed the WD.
</li><li> You called "Add redirector rules" (which adds the rules to protect the SDK).
</li><li> You uploaded the rules to the WD.
</li></ol>
<h2> <span class="mw-headline" id="I_added_registry_rules_but_they_aren.27t_protected"> I added registry rules but they aren't protected </span></h2>
<p>When adding registry rules you usually also wants to protect all subkeys and values, in that case you need to add * or \* to the end of the key.
</p><p>Also not that some registry keys are links (HKEY_CURRENT_USER and HKEY_CLASSES), the WD is a driver and sees only real keys, so you need to give it the full key and not the links.
</p>
<h2> <span class="mw-headline" id="I_tried_to_protect_a_directory.2C_but_it_isn.27t_protected"> I tried to protect a directory, but it isn't protected </span></h2>
<p>The WD doesn't support in protecting directories.
</p>
<h2> <span class="mw-headline" id="I_tried_using_the_64bit_WD_but_I.27m_getting_errors"> I tried using the 64bit WD but I'm getting errors </span></h2>
<p>When you try to install the WD when it's not signed correctly (signed and cross signed), or not signed at all you will get error 577 and a warning from the OS, you can verify it if you boot with digital driver signature enforcement turned off, if the driver loads then, you know it's your signature.
</p>
<h2> <span class="mw-headline" id="I_signed_my_64bit_WD_but_it.27s_not_protecting_or_I.27m_still_getting_errors"> I signed my 64bit WD but it's not protecting or I'm still getting errors </span></h2>
<p>Doing a cross sign is not simple, and it may have been done incorrectly (not using the correct cross sign cert), or it's not done from XP, you can read more about it here: <a class="external text" href="http://www.globalsign.com/support/code-signing/codesign_vista64.php">why you should sign from a XP machine</a>.
</p>
<h2> <span class="mw-headline" id="My_32bit_WD_works_perfectly_on_XP.2FVista_but_some_registry_keys_are_not_protected_on_Win7"> My 32bit WD works perfectly on XP/Vista but some registry keys are not protected on Win7 </span></h2>
<p>There are two drivers for 32bit, one for XP/Vista and one for Win7, make sure you deploy them correctly.
</p>
<!-- 
NewPP limit report
Preprocessor visited node count: 220/1000000
Preprocessor generated node count: 0/1000000
Postâ€expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key komod_wikidb:pcache:idhash:36-0!*!0!!en!*!* and timestamp 20150219185535 -->
</div><div class="printfooter">
Retrieved from "<a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;oldid=1418.html">http://www.komodia.com/wiki/index.php?title=Komodia%27s_Redirector_troubleshooting_guide&amp;oldid=1418</a>"</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="index.php/Komodia's_Redirector_troubleshooting_guide.html" primary="1" context="subject" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="http://www.komodia.com/wiki/index.php?title=Talk:Komodia%27s_Redirector_troubleshooting_guide&amp;action=edit&amp;redlink=1" primary="1" context="talk" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;action=edit.html" primary="1" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;action=history.html" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="http://www.komodia.com/wiki/index.php/User:46.165.222.245" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">46.165.222.245</a></li>
				<li id="pt-anontalk"><a href="http://www.komodia.com/wiki/index.php/User_talk:46.165.222.245" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li>
				<li id="pt-anonlogin"><a href="index.php@title=Special%253AUserLogin&amp;returnto=Komodia%2527s+Redirector+troubleshooting+guide&amp;returntoquery=printable%253Dyes.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
<a href="index.php/Main_Page.html" style="background-image: url(http://www.komodia.com/images/logo.png);" title="Visit the main page"></a>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="index.php/Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-Official-homepage"><a href="../index.php.html">Official homepage</a></li>
				<li id="n-recentchanges"><a href="index.php/Special%253ARecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://www.komodia.com/wiki/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search Komodia [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="index.php/Special%253AWhatLinksHere/Komodia's_Redirector_troubleshooting_guide.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="index.php/Special%253ARecentChangesLinked/Komodia's_Redirector_troubleshooting_guide.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="index.php/Special%253ASpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-permalink"><a href="index.php@title=Komodia%2527s_Redirector_troubleshooting_guide&amp;oldid=1418.html" title="Permanent link to this revision of the page">Permanent link</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 15 January 2015, at 04:10.</li>
		<li id="viewcount">This page has been accessed 14,310 times.</li>
		<li id="privacy"><a href="index.php/Komodia%253APrivacy_policy.html" title="Komodia:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="index.php/Komodia%253AAbout.html" title="Komodia:About">About Komodia</a></li>
		<li id="disclaimer"><a href="index.php/Komodia%253AGeneral_disclaimer.html" title="Komodia:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6898822-1");
pageTracker._trackPageview();
</script><!-- Piwik -->
<script type="text/javascript">
/* <![CDATA[ */
var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.komodia.com/" : "http://piwik.komodia.com/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 6);
piwikTracker.setDocumentTitle("");
piwikTracker.setIgnoreClasses("image");

piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
/* ]]> */
</script><noscript><p><img src="http://piwik.komodia.com/piwik.php?idsite=6" style="border:0" alt=""/></p></noscript>
<!-- /Piwik --><!-- Served in 0.168 secs. --></body></html>